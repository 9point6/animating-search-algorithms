<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html;charset=utf-8">
  <title>connection.coffee</title>
  <link rel="stylesheet" href="http://jashkenas.github.com/docco/resources/docco.css">
</head>
<body>
<div id='container'>
  <div id="background"></div>
  <div id="jump_to">
    Jump To &hellip;
    <div id="jump_wrapper">
      <div id="jump_page">
          <a class="source" href="BFS.html">BFS.coffee</a>
          <a class="source" href="DFS.html">DFS.coffee</a>
          <a class="source" href="DFS2.html">DFS2.coffee</a>
          <a class="source" href="DLS.html">DLS.coffee</a>
          <a class="source" href="algorithm.html">algorithm.coffee</a>
          <a class="source" href="animate.html">animate.coffee</a>
          <a class="source" href="connection.html">connection.coffee</a>
          <a class="source" href="itarative_deepening.html">itarative_deepening.coffee</a>
          <a class="source" href="main.html">main.coffee</a>
          <a class="source" href="point.html">point.coffee</a>
          <a class="source" href="z-other.html">z-other.coffee</a>
      </div>
    </div>
  </div>
  <table cellspacing=0 cellpadding=0>
  <thead>
    <tr>
      <th class=docs><h1>connection.coffee</h1></th>
      <th class=code></th>
    </tr>
  </thead>
  <tbody>
    <tr id='section-Developers'>
      <td class=docs>
        <div class="pilwrap">
          <a class="pilcrow" href="#section-Developers">&#182;</a>
        </div>
        <p>Part of the <strong>Animating Search Algorithms</strong> project</p>

<h2>Developers</h2>

<ul>
<li><a href="http://www.csc.liv.ac.uk/~cs8ib/">Ian Brown</a></li>
<li><a href="http://www.csc.liv.ac.uk/~cs8jrh/">Jack Histon</a></li>
<li><a href="http://www.csc.liv.ac.uk/~cs8cj/">Colin Jackson</a></li>
<li><a href="http://www.csc.liv.ac.uk/~cs8jlj/">Jennifer Jones</a></li>
<li><a href="http://www.csc.liv.ac.uk/~cs8js/">John Sanderson</a></li>
</ul>

<p>Do not modify or distribute without permission.</p>
      </td>
      <td class=code>
        <div class='highlight'><pre></pre></div>
      </td>
    </tr>
    <tr id='section-Main_Documentation'>
      <td class=docs>
        <div class="pilwrap">
          <a class="pilcrow" href="#section-Main_Documentation">&#182;</a>
        </div>
        <h2>Main Documentation</h2>
      </td>
      <td class=code>
        <div class='highlight'><pre></pre></div>
      </td>
    </tr>
    <tr id='section-3'>
      <td class=docs>
        <div class="pilwrap">
          <a class="pilcrow" href="#section-3">&#182;</a>
        </div>
        <p>Graph edge class</p>
      </td>
      <td class=code>
        <div class='highlight'><pre><span class="k">class</span> <span class="nx">connection</span></pre></div>
      </td>
    </tr>
    <tr id='section-connection.constructor(_)'>
      <td class=docs>
        <div class="pilwrap">
          <a class="pilcrow" href="#section-connection.constructor(_)">&#182;</a>
        </div>
        <h3>connection.constructor( )</h3>

<p>Constructor for an edge</p>

<h4>Parameters</h4>

<ul>
<li><code>raphael</code> &ndash; The current paper object. needed for drawing the line</li>
<li><code>pointa</code> &ndash; The first node</li>
<li><code>pointb</code> &ndash; The second node</li>
<li><code>[weight]</code> &ndash; Weight of the the edge</li>
<li><code>[direction]</code> &ndash; The direction of the edge</li>
</ul>
      </td>
      <td class=code>
        <div class='highlight'><pre>    <span class="nv">constructor: </span><span class="nf">( @raphael, @pointa, @pointb, @weight, @direction ) -&gt;</span>
        <span class="nx">@pointa</span><span class="p">.</span><span class="nx">connect</span> <span class="nx">@pointb</span><span class="p">,</span> <span class="err">@</span>
        <span class="nx">@pointb</span><span class="p">.</span><span class="nx">connect</span> <span class="nx">@pointa</span><span class="p">,</span> <span class="err">@</span></pre></div>
      </td>
    </tr>
    <tr id='section-5'>
      <td class=docs>
        <div class="pilwrap">
          <a class="pilcrow" href="#section-5">&#182;</a>
        </div>
        <p>Used to indicate direction for animating nodes.
If true point a is animated, then the connection, then potentially B</p>
      </td>
      <td class=code>
        <div class='highlight'><pre>        <span class="vi">@anim_atob = </span><span class="kc">true</span></pre></div>
      </td>
    </tr>
    <tr id='section-6'>
      <td class=docs>
        <div class="pilwrap">
          <a class="pilcrow" href="#section-6">&#182;</a>
        </div>
        <p>Draw line</p>
      </td>
      <td class=code>
        <div class='highlight'><pre>        <span class="vi">@r = </span><span class="nx">@raphael</span><span class="p">.</span><span class="nx">path</span><span class="p">(</span> <span class="p">)</span>
        <span class="nx">@r</span><span class="p">.</span><span class="nx">attr</span>
            <span class="nv">stroke: </span><span class="s2">&quot;#666&quot;</span>
        <span class="nx">@update_path</span><span class="p">(</span> <span class="p">)</span></pre></div>
      </td>
    </tr>
    <tr id='section-7'>
      <td class=docs>
        <div class="pilwrap">
          <a class="pilcrow" href="#section-7">&#182;</a>
        </div>
        <p>Set event handlers</p>
      </td>
      <td class=code>
        <div class='highlight'><pre>        <span class="nx">@r</span><span class="p">.</span><span class="nx">hover</span> <span class="nx">@hover_in</span><span class="p">,</span> <span class="nx">@hover_out</span>
        <span class="nx">@r</span><span class="p">.</span><span class="nx">click</span> <span class="nx">@click</span></pre></div>
      </td>
    </tr>
    <tr id='section-connection.update_path(_)'>
      <td class=docs>
        <div class="pilwrap">
          <a class="pilcrow" href="#section-connection.update_path(_)">&#182;</a>
        </div>
        <h3>connection.update_path( )</h3>

<p>Updates the connection path. To be used when <code>pointa</code> or <code>pointb</code> have
changed location.</p>
      </td>
      <td class=code>
        <div class='highlight'><pre>    <span class="nv">update_path: </span><span class="o">-&gt;</span>
        <span class="nx">@r</span><span class="p">.</span><span class="nx">attr</span>
            <span class="nv">path: </span><span class="s2">&quot;M#{@pointa.x} #{@pointa.y}L#{@pointb.x} #{@pointb.y}&quot;</span></pre></div>
      </td>
    </tr>
    <tr id='section-connection.remove(_)'>
      <td class=docs>
        <div class="pilwrap">
          <a class="pilcrow" href="#section-connection.remove(_)">&#182;</a>
        </div>
        <h3>connection.remove( )</h3>

<p>Removes the point from the graph</p>

<h4>TODO</h4>

<ul>
<li>Some of this might be better suited in the <code>app</code> class&hellip;</li>
<li>Remove redundant code</li>
</ul>
      </td>
      <td class=code>
        <div class='highlight'><pre>    <span class="nv">remove: </span><span class="o">=&gt;</span>
        <span class="nx">@r</span><span class="p">.</span><span class="nx">animate</span>
           <span class="nv">opacity: </span><span class="mi">0</span><span class="p">,</span>
           <span class="mi">50</span><span class="p">,</span> <span class="s1">&#39;linear&#39;</span><span class="p">,</span> <span class="o">=&gt;</span>
                <span class="nx">@r</span><span class="p">.</span><span class="nx">remove</span><span class="p">(</span> <span class="p">)</span></pre></div>
      </td>
    </tr>
    <tr id='section-10'>
      <td class=docs>
        <div class="pilwrap">
          <a class="pilcrow" href="#section-10">&#182;</a>
        </div>
        <p>Remove from connections in <code>pointa</code></p>
      </td>
      <td class=code>
        <div class='highlight'><pre>                <span class="nv">newcons = </span><span class="p">[]</span>
                <span class="k">for</span> <span class="nx">con</span> <span class="k">in</span> <span class="nx">@pointa</span><span class="p">.</span><span class="nx">connections</span>
                    <span class="k">if</span> <span class="nx">con</span><span class="p">.</span><span class="nx">p</span><span class="p">.</span><span class="nx">id</span> <span class="o">isnt</span> <span class="nx">@pointb</span><span class="p">.</span><span class="nx">id</span>
                        <span class="nx">newcons</span><span class="p">.</span><span class="nx">push</span> <span class="nx">con</span>
                <span class="vi">@pointa.connections = </span><span class="nx">newcons</span></pre></div>
      </td>
    </tr>
    <tr id='section-11'>
      <td class=docs>
        <div class="pilwrap">
          <a class="pilcrow" href="#section-11">&#182;</a>
        </div>
        <p>Remove from connections in <code>pointb</code></p>
      </td>
      <td class=code>
        <div class='highlight'><pre>                <span class="nv">newcons = </span><span class="p">[]</span>
                <span class="k">for</span> <span class="nx">con</span> <span class="k">in</span> <span class="nx">@pointb</span><span class="p">.</span><span class="nx">connections</span>
                    <span class="k">if</span> <span class="nx">con</span><span class="p">.</span><span class="nx">p</span><span class="p">.</span><span class="nx">id</span> <span class="o">isnt</span> <span class="nx">@pointa</span><span class="p">.</span><span class="nx">id</span>
                        <span class="nx">newcons</span><span class="p">.</span><span class="nx">push</span> <span class="nx">con</span>
                <span class="vi">@pointb.connections = </span><span class="nx">newcons</span></pre></div>
      </td>
    </tr>
    <tr id='section-12'>
      <td class=docs>
        <div class="pilwrap">
          <a class="pilcrow" href="#section-12">&#182;</a>
        </div>
        <p>Remove from connections list in <code>app</code> object</p>
      </td>
      <td class=code>
        <div class='highlight'><pre>                <span class="nv">newcons = </span><span class="p">[]</span>
                <span class="k">for</span> <span class="nx">con</span> <span class="k">in</span> <span class="nx">a</span><span class="p">.</span><span class="nx">connections</span>
                    <span class="k">if</span> <span class="nx">con</span><span class="p">.</span><span class="nx">pointa</span><span class="p">.</span><span class="nx">id</span> <span class="o">isnt</span> <span class="nx">@pointa</span><span class="p">.</span><span class="nx">id</span> <span class="o">or</span> <span class="nx">con</span><span class="p">.</span><span class="nx">pointb</span><span class="p">.</span><span class="nx">id</span> <span class="o">isnt</span> <span class="nx">@pointb</span><span class="p">.</span><span class="nx">id</span>
                        <span class="nx">newcons</span><span class="p">.</span><span class="nx">push</span> <span class="nx">con</span>
                <span class="nv">a.connections = </span><span class="nx">newcons</span></pre></div>
      </td>
    </tr>
    <tr id='section-connection.hover_in(_)'>
      <td class=docs>
        <div class="pilwrap">
          <a class="pilcrow" href="#section-connection.hover_in(_)">&#182;</a>
        </div>
        <h3>connection.hover_in( )</h3>

<p>Show hover effect</p>

<h4>Parameters</h4>

<ul>
<li><code>e</code> &ndash; Mouse event object</li>
</ul>

<h4>TODO</h4>

<ul>
<li>Convert this and <code>hover_in</code> into a single method with a toggle</li>
</ul>
      </td>
      <td class=code>
        <div class='highlight'><pre>    <span class="nv">hover_in: </span><span class="p">(</span> <span class="nx">e</span> <span class="p">)</span> <span class="o">=&gt;</span>
        <span class="nx">@r</span><span class="p">.</span><span class="nx">attr</span>
            <span class="nv">cursor: </span><span class="s1">&#39;pointer&#39;</span>
        <span class="nx">@r</span><span class="p">.</span><span class="nx">animate</span>
            <span class="s2">&quot;stroke-width&quot;</span><span class="o">:</span> <span class="mi">3</span>
            <span class="nv">stroke: </span><span class="s2">&quot;#f00&quot;</span><span class="p">,</span></pre></div>
      </td>
    </tr>
    <tr id='section-connection.hover_out(_)'>
      <td class=docs>
        <div class="pilwrap">
          <a class="pilcrow" href="#section-connection.hover_out(_)">&#182;</a>
        </div>
        <h3>connection.hover_out( )</h3>

<p>Remove hover effect</p>

<h4>Parameters</h4>

<ul>
<li><code>e</code> &ndash; Mouse event object</li>
</ul>

<h4>TODO</h4>

<ul>
<li>Convert this and <code>hover_out</code> into a single method with a toggle</li>
</ul>
      </td>
      <td class=code>
        <div class='highlight'><pre>    <span class="nv">hover_out: </span><span class="p">(</span> <span class="nx">e</span> <span class="p">)</span> <span class="o">=&gt;</span>
        <span class="nx">@r</span><span class="p">.</span><span class="nx">attr</span>
            <span class="nv">cursor: </span><span class="s1">&#39;normal&#39;</span>
        <span class="nx">@r</span><span class="p">.</span><span class="nx">animate</span>
            <span class="s2">&quot;stroke-width&quot;</span><span class="o">:</span> <span class="mi">1</span>
            <span class="nv">stroke: </span><span class="s2">&quot;#666&quot;</span><span class="p">,</span>
            <span class="mi">100</span></pre></div>
      </td>
    </tr>
    <tr id='section-connection.click(_)'>
      <td class=docs>
        <div class="pilwrap">
          <a class="pilcrow" href="#section-connection.click(_)">&#182;</a>
        </div>
        <h3>connection.click( )</h3>

<p>Connection click handler. Currently just does a spark animation.</p>

<h4>Parameters</h4>

<ul>
<li><code>e</code> &ndash; Mouse event object</li>
</ul>

<h4>TODO</h4>

<ul>
<li>Bring up a context menu to edit/remove the connection</li>
</ul>
      </td>
      <td class=code>
        <div class='highlight'><pre>    <span class="nv">click: </span><span class="p">(</span> <span class="nx">e</span> <span class="p">)</span> <span class="o">=&gt;</span>
        <span class="nx">@spark</span><span class="p">(</span> <span class="p">)</span></pre></div>
      </td>
    </tr>
    <tr id='section-connection.spark(_)'>
      <td class=docs>
        <div class="pilwrap">
          <a class="pilcrow" href="#section-connection.spark(_)">&#182;</a>
        </div>
        <h3>connection.spark( )</h3>

<p>Performs an animation along the edge. To be used when demonstrating the
process of an algorithm, etc.</p>

<h4>Parameters</h4>

<ul>
<li><code>[a2b]</code> &ndash; Animate from A to B?</li>
</ul>
      </td>
      <td class=code>
        <div class='highlight'><pre>    <span class="nv">spark: </span><span class="nf">( a2b = true ) -&gt;</span>
        <span class="nv">start_point = </span><span class="k">if</span> <span class="nx">a2b</span> <span class="k">then</span> <span class="nx">@pointa</span> <span class="k">else</span> <span class="nx">@pointb</span>
        <span class="nb">window</span><span class="p">.</span><span class="nv">spark = </span><span class="nx">@raphael</span><span class="p">.</span><span class="nx">ellipse</span> <span class="nx">start_point</span><span class="p">.</span><span class="nx">x</span><span class="p">,</span> <span class="nx">start_point</span><span class="p">.</span><span class="nx">y</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">20</span>
        <span class="nb">window</span><span class="p">.</span><span class="nx">spark</span><span class="p">.</span><span class="nx">attr</span>
            <span class="nv">fill: </span><span class="s2">&quot;r#f00-#fff&quot;</span>
            <span class="nv">stroke: </span><span class="s2">&quot;transparent&quot;</span></pre></div>
      </td>
    </tr>
    <tr id='section-17'>
      <td class=docs>
        <div class="pilwrap">
          <a class="pilcrow" href="#section-17">&#182;</a>
        </div>
        <p>Raphael does not currently support alpha gradients, but SVG and VML
both do. This code changes the necessary elements to do this manually</p>
      </td>
      <td class=code>
        <div class='highlight'><pre>        <span class="nv">grad = </span><span class="nx">$</span><span class="p">(</span> <span class="nx">spark</span><span class="p">.</span><span class="nx">node</span> <span class="p">).</span><span class="nx">attr</span> <span class="s2">&quot;fill&quot;</span>
        <span class="nv">grad = </span><span class="nx">grad</span><span class="p">.</span><span class="nx">substring</span> <span class="mi">4</span><span class="p">,</span> <span class="nx">grad</span><span class="p">.</span><span class="nx">length</span> <span class="o">-</span> <span class="mi">1</span>
        <span class="nv">stops = </span><span class="nx">$</span><span class="p">(</span> <span class="nx">grad</span> <span class="p">).</span><span class="nx">children</span><span class="p">(</span> <span class="p">)</span>
        <span class="nx">$</span><span class="p">(</span> <span class="nx">stops</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="p">).</span><span class="nx">attr</span> <span class="s2">&quot;stop-opacity&quot;</span><span class="p">,</span> <span class="s2">&quot;1&quot;</span>
        <span class="nx">$</span><span class="p">(</span> <span class="nx">stops</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="p">).</span><span class="nx">attr</span> <span class="s2">&quot;stop-opacity&quot;</span><span class="p">,</span> <span class="s2">&quot;0&quot;</span>

        <span class="nb">window</span><span class="p">.</span><span class="nx">spark</span><span class="p">.</span><span class="nx">animateAlong</span> <span class="nx">@r</span><span class="p">,</span> <span class="mi">500</span><span class="p">,</span> <span class="kc">false</span><span class="p">,</span> <span class="o">=&gt;</span>
            <span class="nx">spark</span><span class="p">.</span><span class="nx">remove</span><span class="p">(</span> <span class="p">)</span></pre></div>
      </td>
    </tr>
    <tr id='section-connection.update_style(_)'>
      <td class=docs>
        <div class="pilwrap">
          <a class="pilcrow" href="#section-connection.update_style(_)">&#182;</a>
        </div>
        <h3>connection.update_style( )</h3>

<p>Perform animatrions on the connection. Used by search algorithms.</p>

<h4>Parameters</h4>

<ul>
<li><code>style_name</code> &ndash; Name of preset style used to update the look of the connection.</li>
</ul>

<h4>TODO</h4>

<ul>
<li>Add all needed animations</li>
<li>Maybe enumerate?</li>
</ul>
      </td>
      <td class=code>
        <div class='highlight'><pre>    <span class="nv">update_style: </span><span class="nf">( style_name ) -&gt;</span>
        <span class="nv">anim_speed = </span><span class="mi">100</span>
        <span class="k">switch</span> <span class="nx">style_name</span></pre></div>
      </td>
    </tr>
    <tr id='section-19'>
      <td class=docs>
        <div class="pilwrap">
          <a class="pilcrow" href="#section-19">&#182;</a>
        </div>
        <p>The connection is to be reset back to &lsquo;default&rsquo;</p>
      </td>
      <td class=code>
        <div class='highlight'><pre>            <span class="k">when</span> <span class="s2">&quot;normal&quot;</span>
                <span class="nx">@r</span><span class="p">.</span><span class="nx">animate</span>
                    <span class="nv">stroke: </span><span class="s2">&quot;#666&quot;</span>
                    <span class="s2">&quot;stroke-width&quot;</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span>
                    <span class="nx">anim_speed</span></pre></div>
      </td>
    </tr>
    <tr id='section-20'>
      <td class=docs>
        <div class="pilwrap">
          <a class="pilcrow" href="#section-20">&#182;</a>
        </div>
        <p>The connection is currently being &lsquo;looked at&rsquo;</p>
      </td>
      <td class=code>
        <div class='highlight'><pre>            <span class="k">when</span> <span class="s2">&quot;viewing&quot;</span>
                <span class="nx">@r</span><span class="p">.</span><span class="nx">animate</span>
                    <span class="nv">stroke: </span><span class="s2">&quot;#008000&quot;</span>
                    <span class="s2">&quot;stroke-width&quot;</span><span class="o">:</span> <span class="mi">10</span><span class="p">,</span>
                    <span class="nx">anim_speed</span></pre></div>
      </td>
    </tr>
    <tr id='section-21'>
      <td class=docs>
        <div class="pilwrap">
          <a class="pilcrow" href="#section-21">&#182;</a>
        </div>
        <p>The connection is an option for later in the algorithm</p>
      </td>
      <td class=code>
        <div class='highlight'><pre>            <span class="k">when</span> <span class="s2">&quot;potential&quot;</span>
                <span class="nx">@r</span><span class="p">.</span><span class="nx">animate</span>
                    <span class="nv">stroke: </span><span class="s2">&quot;#0247FE&quot;</span>
                    <span class="s2">&quot;stroke-width&quot;</span><span class="o">:</span> <span class="mi">5</span><span class="p">,</span>
                    <span class="nx">anim_speed</span></pre></div>
      </td>
    </tr>
    <tr id='section-22'>
      <td class=docs>
        <div class="pilwrap">
          <a class="pilcrow" href="#section-22">&#182;</a>
        </div>
        <p>The connection has been visited by the algorithm</p>

      </td>
      <td class=code>
        <div class='highlight'><pre>            <span class="k">when</span> <span class="s2">&quot;visited&quot;</span>
                <span class="nx">@r</span><span class="p">.</span><span class="nx">animate</span>
                    <span class="nv">stroke: </span><span class="s2">&quot;#A40000&quot;</span>
                    <span class="s2">&quot;stroke-width&quot;</span><span class="o">:</span> <span class="mi">3</span><span class="p">,</span>
                    <span class="nx">anim_speed</span></pre></div>
      </td>
    </tr>
  </table>
</div>
</body>
